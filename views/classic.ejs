<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BeSoSmash üí•</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700;800&family=Outfit:wght@400;700;900&display=swap"
        rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Outfit', 'sans-serif'],
                        mono: ['"JetBrains Mono"', 'monospace'],
                    },
                    animation: {
                        'gradient-x': 'gradient-x 15s ease infinite',
                    },
                    keyframes: {
                        'gradient-x': {
                            '0%, 100%': {
                                'background-size': '200% 200%',
                                'background-position': 'left center'
                            },
                            '50%': {
                                'background-size': '200% 200%',
                                'background-position': 'right center'
                            },
                        },
                    }
                }
            }
        }
    </script>
    <style>
        /* A little custom CSS for the arcade glow */
        .neon-glow {
            text-shadow: 0 0 10px currentColor, 0 0 20px currentColor, 0 0 30px currentColor;
        }

        .box-glow {
            box-shadow: 0 0 15px currentColor, inset 0 0 10px currentColor;
        }

        body {
            background: linear-gradient(-45deg, #0f172a, #1e1b4b, #312e81, #0f172a);
            background-size: 400% 400%;
        }

        .glass-panel {
            background: rgba(15, 23, 42, 0.4);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }
    </style>
</head>

<body
    class="text-white font-sans flex flex-col items-center min-h-screen p-5 transition-colors duration-100 animate-gradient-x overflow-x-hidden">

    <header class="text-center mt-8 mb-6 z-10">
        <h1
            class="text-6xl font-black text-transparent bg-clip-text bg-gradient-to-r from-rose-500 via-purple-500 to-yellow-500 neon-glow animate-pulse">
            BeSoSmash
        </h1>
        <p class="text-slate-400 mt-2 tracking-widest text-sm">GLOBAL KEYBOARD DESTRUCTION EVENT</p>
    </header>
    <%- include('partials/nav') %>
        <div class="w-full max-w-3xl mb-8 relative">
            <!-- Wrapper just for the shake animation -->
            <div class="rounded-3xl" style="margin: -20px; padding: 20px;">
                <div id="game-container" class="w-full text-center z-10">

                    <div id="setup-panel" class="mb-5 glass-panel p-10 rounded-3xl relative overflow-hidden group">
                        <div
                            class="absolute inset-0 bg-gradient-to-br from-white/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500 pointer-events-none">
                        </div>
                        <h2 class="text-3xl font-black text-yellow-400 mb-8 tracking-wider">ENTER THE ARENA</h2>
                        <div class="flex justify-center items-center gap-6">
                            <input type="text" id="username" placeholder="CODENAME" maxlength="12"
                                class="bg-black/50 border border-slate-600/50 text-white text-3xl p-5 rounded-2xl text-center w-72 focus:outline-none focus:border-rose-500 focus:ring-4 focus:ring-rose-500/30 uppercase transition-all font-black shadow-inner">
                            <button onclick="startGame('classic')"
                                class="bg-gradient-to-r from-rose-600 to-orange-500 hover:from-rose-500 hover:to-orange-400 text-white font-black py-5 px-10 rounded-2xl text-3xl shadow-[0_0_20px_rgba(225,29,72,0.6)] hover:shadow-[0_0_35px_rgba(225,29,72,0.8)] hover:scale-105 transition-all duration-300 active:scale-95 border border-white/20 relative overflow-hidden group/btn">
                                <span class="relative z-10">RAGE</span>
                                <div
                                    class="absolute inset-0 bg-white/20 translate-y-full group-hover/btn:translate-y-0 transition-transform duration-300">
                                </div>
                            </button>
                        </div>
                    </div>

                    <!-- Post-Game Match Summary Panel -->
                    <div id="game-over-panel"
                        class="hidden mb-5 glass-panel p-10 rounded-3xl relative overflow-hidden group">
                        <div
                            class="absolute inset-0 bg-gradient-to-br from-rose-600/10 to-transparent pointer-events-none">
                        </div>
                        <h2 class="text-3xl font-black text-rose-500 mb-2 tracking-widest drop-shadow-md">DESTRUCTION
                            COMPLETE</h2>
                        <p class="text-slate-400 font-bold tracking-widest text-sm mb-6 uppercase">MATCH RESULTS</p>

                        <div
                            class="flex flex-col items-center justify-center gap-2 mb-8 bg-black/40 p-6 rounded-2xl border border-white/5">
                            <span class="text-slate-500 font-black text-xs tracking-widest uppercase">FINAL SCORE</span>
                            <span id="final-score-display"
                                class="text-7xl font-mono font-black text-yellow-500 drop-shadow-[0_0_15px_rgba(234,179,8,0.5)]">0</span>
                            <span id="final-rank-display" class="text-2xl font-black mt-2">NOVICE</span>

                            <div
                                class="flex w-full justify-between items-center mt-6 pt-6 border-t border-white/10 px-4">
                                <div class="text-center w-1/2 border-r border-white/10">
                                    <p class="text-slate-500 font-bold text-[10px] tracking-widest uppercase mb-1">
                                        GLOBAL RANK</p>
                                    <p id="absolute-rank-display" class="font-mono text-3xl font-black text-white">#--
                                    </p>
                                </div>
                                <div class="text-center w-1/2">
                                    <p class="text-slate-500 font-bold text-[10px] tracking-widest uppercase mb-1">AVRG
                                        SPEED</p>
                                    <p id="final-kps-display" class="font-mono text-3xl font-black text-sky-400">0.0
                                        <span class="text-sm">KPS</span></p>
                                </div>
                            </div>
                        </div>

                        <div class="flex justify-center items-center gap-4 w-full">
                            <button onclick="shareScore()"
                                class="flex-1 bg-slate-800 hover:bg-slate-700 text-slate-300 font-black py-4 px-6 rounded-2xl text-xl transition-all duration-300 active:scale-95 border border-slate-600 hover:text-white shadow-lg flex justify-center items-center gap-2">
                                <span>SHARE</span> <span>üìã</span>
                            </button>
                            <button onclick="resetGame()"
                                class="flex-1 bg-gradient-to-r from-rose-600 to-orange-500 hover:from-rose-500 hover:to-orange-400 text-white font-black py-4 px-6 rounded-2xl text-xl shadow-[0_0_20px_rgba(225,29,72,0.6)] hover:shadow-[0_0_35px_rgba(225,29,72,0.8)] hover:scale-[1.02] transition-all duration-300 active:scale-95 border border-white/20">
                                PLAY AGAIN üîÑ
                            </button>
                        </div>
                    </div>

                    <div id="smash-zone"
                        class="hidden relative glass-panel border-4 border-dashed border-rose-500/50 rounded-3xl p-8 flex flex-col items-center justify-center select-none box-glow text-rose-500 h-96 transition-all">

                        <div class="absolute top-6 left-8 text-left">
                            <p class="text-slate-400/80 text-sm font-bold tracking-widest uppercase">KPS (Keys/Sec)</p>
                            <p id="kps-display"
                                class="text-4xl font-mono font-black text-yellow-400 drop-shadow-[0_0_10px_rgba(250,204,21,0.5)]">
                                0.0</p>
                        </div>

                        <div class="absolute top-6 right-8 text-right flex flex-col items-end">
                            <div
                                class="flex items-center gap-2 bg-rose-500/20 px-3 py-1 rounded-full border border-rose-500/30 mb-2">
                                <span class="text-rose-400 animate-pulse">‚è±Ô∏è</span>
                                <span id="timer-display"
                                    class="font-mono font-black text-xl text-rose-300 w-12 text-right">5.0s</span>
                            </div>
                        </div>

                        <div class="absolute bottom-6 right-8 text-right">
                            <p class="text-slate-400/80 text-sm font-bold tracking-widest uppercase">CURRENT RANK</p>
                            <p id="rank-display" class="text-3xl font-black text-slate-300 neon-glow">NOVICE</p>
                        </div>

                        <h2 id="status-text"
                            class="text-4xl font-black text-white mix-blend-overlay opacity-80 mt-12 tracking-widest">
                            SMASH YOUR
                            KEYBOARD!
                        </h2>
                        <div id="score-display"
                            class="text-[12rem] font-mono font-black text-white leading-none tracking-tighter neon-glow mt-4">
                            0
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="leaderboard-section"
            class="w-full max-w-4xl glass-panel p-8 md:p-12 rounded-3xl z-10 relative overflow-hidden mt-8 shadow-[0_0_50px_rgba(0,0,0,0.6)] border border-white/5">
            <div
                class="absolute top-0 inset-x-0 h-1 bg-gradient-to-r from-transparent via-yellow-400/50 to-transparent">
            </div>

            <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4">
                <h3
                    class="text-4xl md:text-5xl font-black text-transparent bg-clip-text bg-gradient-to-r from-yellow-400 to-amber-600 flex items-center gap-3 drop-shadow-[0_0_15px_rgba(250,204,21,0.3)]">
                    <span>üèÜ</span> HALL OF CHAOS
                </h3>
                <span
                    class="text-xs font-bold text-emerald-400 tracking-widest uppercase bg-emerald-400/10 px-4 py-2 rounded-full border border-emerald-400/20 shadow-[0_0_15px_rgba(52,211,153,0.3)] flex items-center gap-2">
                    <span class="w-2.5 h-2.5 rounded-full bg-emerald-400 animate-pulse"></span>
                    Live Updates
                </span>
            </div>

            <div class="mb-8 relative group">
                <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                    <svg class="w-6 h-6 text-slate-400 group-focus-within:text-rose-500 transition-colors" fill="none"
                        stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                    </svg>
                </div>
                <input type="text" id="leaderboard-search" placeholder="SEARCH CODENAMES..."
                    class="w-full bg-black/60 border border-slate-700/50 text-white text-2xl p-5 pl-12 rounded-2xl focus:outline-none focus:border-rose-500 focus:ring-4 focus:ring-rose-500/20 transition-all placeholder:text-slate-600 uppercase font-bold shadow-inner block">
            </div>

            <ul id="leaderboard-list" class="space-y-4">
                <!-- Data fetched from API -->
            </ul>

            <div class="mt-8 text-center">
                <button id="load-more-btn"
                    class="hidden relative overflow-hidden group/load bg-slate-800/80 hover:bg-slate-700 text-slate-300 px-8 py-4 rounded-2xl text-lg font-bold tracking-widest transition-all uppercase border border-slate-600 hover:border-slate-400 hover:text-white shadow-lg">
                    <span class="relative z-10 flex items-center gap-2">
                        <span>LOAD MORE</span>
                        <svg class="w-5 h-5 group-hover/load:translate-y-1 transition-transform" fill="none"
                            stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7">
                            </path>
                        </svg>
                    </span>
                </button>
            </div>
        </div>
        <div id="toast-container"
            class="fixed top-10 left-1/2 -translate-x-1/2 z-50 flex flex-col gap-3 pointer-events-none"></div>
        <script src="/js/game.js"></script>
</body>

</html>