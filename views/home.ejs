<!DOCTYPE html>
<html lang="en">

<head>
    <%- include('partials/head', { title: 'BeSoSmash' }) %>
        <style>
            body {
                background: linear-gradient(-45deg, #0f172a, #1e1b4b, #312e81, #0f172a);
                background-size: 400% 400%;
            }
        </style>
</head>

<body
    class="text-white font-sans flex flex-col items-center min-h-screen p-5 transition-colors duration-1000 animate-gradient-x overflow-x-hidden">

    <%- include('partials/hero') %>

        <%- include('partials/mode_cards') %>

            <%- include('partials/info_cards') %>

                <%- include('partials/footer') %>

                    <script src="/socket.io/socket.io.js"></script>
                    <script>
                        const socket = io();
                        const countEl = document.getElementById('global-smash-count');
                        const rawCount = document.getElementById('global-smash-count').innerText.replace(/,/g, '').trim();
                        let currentCount = parseInt(rawCount, 10) || 0;

                        socket.on('globalSmashCount', (newCount) => {
                            if (!countEl || newCount === currentCount) return;

                            // Pop effect
                            anime({
                                targets: countEl,
                                scale: [1, 1.15, 1],
                                duration: 400,
                                easing: 'easeOutElastic(1, .8)'
                            });

                            // Smooth counting effect (like a sports scoreboard)
                            anime({
                                targets: { val: currentCount },
                                val: newCount,
                                duration: 1500, // 1.5 seconds to count up
                                easing: 'easeOutExpo',
                                round: 1, // Round to integer during animation
                                update: function (anim) {
                                    countEl.innerText = anim.animatables[0].target.val.toLocaleString();
                                },
                                complete: function () {
                                    currentCount = newCount;
                                    countEl.innerText = currentCount.toLocaleString();
                                }
                            });
                        });
                    </script>
</body>

</html>